# Redirect расширение для Yii2

Производит редирек со старых ссылок на новые. База ссылок может быть содержаться в разных источниках. 
В данной версии реализован репозиторий для работы с CSV файлами.

## Установка

Устанвливается через [Composer](http://getcomposer.org/download/) 

```bash
composer require anatoliy700/yii2-redirect
```
или добавить 

```json
"anatoliy700/yii2-redirect": "*"
```

в разделе `require` вашего composer.json файла.

## Использование

Подключить в конфигурации приложения в разделе модули:

```php
'modules => [
    'redirect' => [
        'class' => '\anatoliy700\redirect\Module',
        'urlRepository' => [
            'class' => '\anatoliy700\redirect\repositories\CSVRepository',
            'filePath' => '@app/redirectFile/redirect.csv'
        ]
    ]
]'
```
Выше указана минимально необходимая конфигурация модуля

Модуль может работать в двух вариантах: `предзагрузка` и `постзагрузка`

`Предзагрузка` реазлизуется добавлением модуля в раздел `bootstrap` конфигурации приложения:

```php
'bootstrap' => ['redirect']
```
В этом случае все входящие запросы сначала обрабатываются модулем 'Redirect', и если маршрут, который должен быть переадресован, не был найден, вся последующая обработка передается приложению.
Не очень экономный вариант по ресурсам, так как каждый запрос будет обрабатываться модулем 'Redirect'.

`Постзагрузка` реализуется добавлением модуля как маршрут в `errorAction` компонента `errorHandler`:

```php
'components' => [
     'class' => \yii\web\ErrorHandler::class,
      'errorAction' => 'redirect'
]
```

Этот вариант подключения предпочтительнее, так как управление моулю 'Redirect' передается только в случае если приложение не может обработать запрошенный маршрут и должно было вернуть ошибку '404'.

